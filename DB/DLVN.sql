create table country(
	countryid char(3) primary key,
	countryname varchar(30))
create table province(
	provinceid char(3) primary key,
	provincename varchar(30),
	population int,
	Area float,
	countryid char(3))
create table border(
	provinceid char(3),
	nationid char(3),
	primary key(provinceid,nationid))
create table neighbor(
	provinceid char(3),
	neighborid char(3),
	primary key(provinceid,neighborid))
insert into country
values
('C01','Bac'),
('C02','Trung'),
('C03','Nam')
insert into province
values
('HGI','Ha Giang','854679','7929.5','C01'),
('CBA','Cao Bang','530341','6700.3','C01'),
('LCi','Lao Cai','70342','6364','C01'),
('SLA','Son La','1248415','14123.5','C01'),
('LCA','Lai Chau','460196','9068.8','C01'),
('BKA','Bac Kan','313905','4859.96','C01'),
('LSN','Lang Son','781655','8310.2','C01'),
('TQU','Tuyen Quang','784811','5867.9','C01'),
('YBA','Yen Bai','82103','6887.7','C01'),
('TNG','Thai Nguyen','1286751','3536.4','C01'),
('DBI','Dien Bien','598856','9541','C01'),
('PTH','Phu Tho','1463726','3534.6','C01'),
('VPH','Vinh Phuc','1154154','1235.2','C01'),
('BGI','Bac Giang','1803950','3851.4','C01'),
('BNI','Bac Ninh','1368840','822.7','C01'),
('HNO','Ha Noi','8053663','3358.9','C01'),
('QNH','Quang Ninh','132324','6177.70','C01'),
('HDU','Hai Duong','1892254','1668.2','C01'),
('HPG','Hai Phong','2028514','1522.5','C01'),
('HBI','Hoa Binh','845131','4591','C01'),
('HYE','Hung Yen','1252731','930.2','C01'),
('HNA','Ha Nam','8528','860.9','C01'),
('TBH','Thai Binh','1860447','1570.5','C01'),
('NDH','Nam Dinh','1780393','1668','C01'),
('NBI','Ninh Binh','982487','1387','C01'),
('THA','Thanh Hoa','3640128','11114.7','C02'),
('NAN','Nghe An','3327791','16493.7','C02'),
('HTI','Ha Tinh','1288866','5990.7','C02'),
('QBI','Quang Binh','89543','8065.3','C02'),
('QTR','Quang Tri','632375','4739.8','C02'),
('TTH','Thua Thien Hue','1128620','5048.2','C02'),
('DNG','Da Nang','1134310','1284.9','C02'),
('QNA','Quang Nam','1495812','10574.7','C02'),
('QNG','Quang Ngai','1231697','1535.2','C02'),
('KTU','Kon Tum','140438','9674.2','C02'),
('GLA','Gia Lai','1513847','15510.8','C02'),
('BDI','Binh Dinh','1486918','6066.2','C02'),
('PYE','Phu Yen','961152','5023.4','C02'),
('DLA','Dak Lak','1869322','13030.5','C02'),
('KHA','Khanh Hoa','1231107','5137.8','C02'),
('DKN','Dak Nong','622168','6509.3','C02'),
('LDG','Lam Dong','1296606','9783.2','C02'),
('NTH','Ninh Thuan','590467','3355.3','C02'),
('BPC','Binh Phuoc','994679','6877','C03'),
('TNI','Tay Ninh','1169165','4041.4','C03'),
('BDU','Binh Duong','2426561','2694.7','C03'),
('DNA','Dong Nai','3097107','5905.7','C03'),
('BTN','Binh Thuan','1230808','7812.8','C02'),
('HCM','TP Ho Chi Minh','8993082','2061','C03'),
('LAN','Long An','1688547','4490.2','C03'),
('VTB','Ba Ria Vung Tau','1148313','1980.8','C03'),
('DTP','Dong Thap','1599504','3383.8','C03'),
('AGI','An Giang','1908352','3536.7','C03'),
('TGG','Tien Giang','1764185','2556.5','C03'),
('VLG','Vinh Long','1022791','1475','C03'),
('BTR','Ben Tre','1288463','2394.6','C03'),
('CTH','Can Tho','1235171','1439.2','C03'),
('KGI','Kien Giang','1723067','6348.8','C03'),
('TVH','Tra Vinh','1009168','2358.2','C03'),
('HAG','Hau Giang','733017','1621.8','C03'),
('STR','Soc Trang','1199653','3311.8','C03'),
('BLI','Bac Lieu','907236','2669','C03'),
('CMU','Ca Mau','1194476','5294.8','C03')
delete from province
insert into border
values
('DBI','CHN'),
('LCA','CHN'),
('LCI','CHN'),
('HGI','CHN'),
('CBA','CHN'),
('LSN','CHN'),
('QNH','CHN'),
('DBI','LAO'),
('SLA','LAO'),
('THA','LAO'),
('NAN','LAO'),
('HTI','LAO'),
('QBI','LAO'),
('QTR','LAO'),
('TTH','LAO'),
('QNA','LAO'),
('KTU','LAO'),
('KTU','CPC'),
('GLA','CPC'),
('DLA','CPC'),
('DKN','CPC'),
('BPC','CPC'),
('TNI','CPC'),
('LAN','CPC'),
('DTP','CPC'),
('AGI','CPC'),
('KGI','CPC')
select * from province
insert into neighbor
values
('HGI','CBA'),
('HGI','YBA'),
('HGI','LCI'),
('HGI','TQU'),
('CBA','HGI'),
('CBA','BKA'),
('CBA','TQU'),
('CBA','LSN'),
('LCI','LCA'),
('LCI','HGI'),
('LCI','YBA'),
('SLA','YBA'),
('SLA','LCA'),
('SLA','PTH'),
('SLA','HBI'),
('SLA','DBI'),
('SLA','THA'),
('LCA','DBI'),
('LCA','LCI'),
('LCA','YBA'),
('LCA','SLA'),
('BKA','CBA'),
('BKA','LSN'),
('BKA','TNG'),
('BKA','TQU'),
('LSN','CBA'),
('LSN','QNH'),
('LSN','BGI'),
('LSN','BKA'),
('LSN','TNG'),
('TQU','TNG'),
('TQU','BKA'),
('TQU','PTH'),
('TQU','YBA'),
('TQU','VPH'),
('TQU','HGI'),
('TQU','CBA'),
('YBA','TQU'),
('YBA','PTH'),
('YBA','LCA'),
('YBA','SLA'),
('YBA','HGI'),
('YBA','LCI'),
('TNG','BKA'),
('TNG','VPH'),
('TNG','TQU'),
('TNG','LSN'),
('TNG','BGI'),
('TNG','HNO'),
('HBI','PTH'),
('HBI','HNA'),
('HBI','NBI'),
('HBI','HNO'),
('HBI','SLA'),
('HBI','THA'),
('HYE','HDU'),
('HYE','HNO'),
('HYE','HNA'),
('HYE','TBH'),
('HYE','BNI'),
('HNA','HNO'),
('HNA','HYE'),
('HNA','TBH'),
('HNA','NDH'),
('HNA','NBI'),
('HNA','HBI'),
('TBH','HDU'),
('TBH','HYE'),
('TBH','HPG'),
('TBH','HNA'),
('TBH','NDH'),
('NDH','TBH'),
('NDH','HNA'),
('NDH','NBI'),
('NBI','HNA'),
('NBI','NDH'),
('NBI','HBI'),
('NBI','THA'),
('THA','SLA'),
('THA','HBI'),
('THA','NBI'),
('THA','NAN'),
('NAN','HTI'),
('NAN','THA'),
('HTI','NAN'),
('HTI','QBI'),
('QBI','HTI'),
('QBI','QTR'),
('QTR','QBI'),
('QTR','TTH'),
('DBI','SLA'),
('DBI','LCA'),
('PTH','VPH'),
('PTH','SLA'),
('PTH','HBI'),
('PTH','TQU'),
('PTH','YBA'),
('PTH','HNO'),
('VPH','PTH'),
('VPH','TNG'),
('VPH','TQU'),
('VPH','HNO'),
('BGI','QNH'),
('BGI','LSN'),
('BGI','HNO'),
('BGI','TNG'),
('BGI','BNI'),
('BGI','HDU'),
('BNI','HDU'),
('BNI','HNO'),
('BNI','HYE'),
('BNI','BGI'),
('HNO','TNG'),
('HNO','VPH'),
('HNO','HNA'),
('HNO','HBI'),
('HNO','BGI'),
('HNO','BNI'),
('HNO','HYE'),
('HNO','PTH'),
('QNH','HDU'),
('QNH','HPG'),
('QNH','BGI'),
('QNH','LSN'),
('HDU','BGI'),
('HDU','QNH'),
('HDU','HPG'),
('HDU','BNI'),
('HDU','HYE'),
('HDU','TBH'),
('HPG','QNH'),
('HPG','HDU'),
('HPG','TBH'),
('TTH','QTR'),
('TTH','QNA'),
('TTH','DNG'),
('DNG','TTH'),
('DNG','QNA'),
('QNA','TTH'),
('QNA','DNG'),
('QNA','QNG'),
('QNA','KTU'),
('QNG','QNA'),
('QNG','BDI'),
('QNG','KTU'),
('QNG','GLA'),
('KTU','QNA'),
('KTU','QNG'),
('KTU','GLA'),
('GLA','QNG'),
('GLA','BDI'),
('GLA','PYE'),
('GLA','DLA'),
('GLA','KTU'),
('BDI','GLA'),
('BDI','QNG'),
('BDI','PYE'),
('PYE','BDI'),
('PYE','KHA'),
('PYE','DLA'),
('PYE','GLA'),
('DLA','GLA'),
('DLA','PYE'),
('DLA','LDG'),
('DLA','DKN'),
('DLA','KHA'),
('KHA','PYE'),
('KHA','DLA'),
('KHA','NTH'),
('KHA','LDG'),
('DKN','DLA'),
('DKN','BPC'),
('DKN','LDG'),
('LDG','KHA'),
('LDG','NTH'),
('LDG','DKN'),
('LDG','DNA'),
('LDG','BPC'),
('LDG','BTN'),
('LDG','DLA'),
('NTH','KHA'),
('NTH','BTN'),
('NTH','LDG'),
('BPC','LDG'),
('BPC','DNA'),
('BPC','BDU'),
('BPC','DKN'),
('BPC','TNI'),
('TNI','BDU'),
('TNI','BPC'),
('TNI','HCM'),
('TNI','LAN'),
('BDU','BPC'),
('BDU','HCM'),
('BDU','TNI'),
('BDU','DNA'),
('DNA','BTN'),
('DNA','BDU'),
('DNA','HCM'),
('DNA','VTB'),
('DNA','LDG'),
('DNA','BPC'),
('BTN','LDG'),
('BTN','NTH'),
('BTN','DNA'),
('BTN','VTB'),
('HCM','BDU'),
('HCM','TNI'),
('HCM','DNA'),
('HCM','LAN'),
('HCM','VTB'),
('HCM','TGG'),
('LAN','HCM'),
('LAN','TNI'),
('LAN','DTP'),
('LAN','TGG'),
('VTB','DNA'),
('VTB','HCM'),
('VTB','BTN'),
('DTP','LAN'),
('DTP','TGG'),
('DTP','AGI'),
('DTP','VLG'),
('DTP','CTH'),
('AGI','DTP'),
('AGI','KGI'),
('AGI','CTH'),
('TGG','HCM'),
('TGG','DTP'),
('TGG','BTR'),
('TGG','VLG'),
('TGG','LAN'),
('VLG','BTR'),
('VLG','TVH'),
('VLG','CTH'),
('VLG','DTP'),
('VLG','TGG'),
('VLG','HAG'),
('VLG','STR'),
('BTR','VLG'),
('BTR','TVH'),
('BTR','TGG'),
('CTH','AGI'),
('CTH','VLG'),
('CTH','DTP'),
('CTH','HAG'),
('CTH','KGI'),
('KGI','CMU'),
('KGI','AGI'),
('KGI','HAG'),
('KGI','BLI'),
('KGI','CTH'),
('TVH','VLG'),
('TVH','STR'),
('TVH','BTR'),
('HAG','STR'),
('HAG','KGI'),
('HAG','BLI'),
('HAG','CTH'),
('HAG','VLG'),
('STR','TVH'),
('STR','VLG'),
('STR','HAG'),
('STR','BLI'),
('BLI','HAG'),
('BLI','STR'),
('BLI','CMU'),
('BLI','KGI'),
('CMU','BLI'),
('CMU','KGI')
select * from neighbor
delete from neighbor
select * from neighbor A
where not exists
(select * 
from neighbor
where A.provinceid=neighborid and A.neighborid = provinceid)
select provinceid ,count(*)
from neighbor
group by provinceid
select count(*)
from border
cac tinh giap 2 nuoc ngoai
select A.provinceid,B.provincename
from border A,province B
where A.provinceid=B.provinceid
group by A.provinceid,B.provincename
having count(*)>=2
tim cac tinh thuoc mien trung giap voi mien bac
select A.* 
from province A, neighbor B,province C
where A.provinceid=B.provinceid and A.countryid='C02' and B.neighborid=C.provinceid and C.countryid='C01'
tinh dien tich trung binh cua cac tinh giap voi nuoc ngoai
select  avg(area)
from province
where provinceid in (
select provinceid
from border)
tinh nao co dt lon,nho nhat
select * 
from province
where countryid='C03' and area >= all(select area
				 from province
				 where countryid='C03')
tinh co dien tich lon nhat moi mien
select countryid,provinceid,provincename,area
from province A
where  area >= all(select area
				 from province
				 where A.countryid=countryid)
order by countryid
tinh nao cua mien nam co dt lon hon dien tich trung binh cua cac tinh mien bac
select *
from province
where countryid='C03' and area>= all(select avg(area)
					from province
					where countryid='C01')
tinh nao cua mien nam co mat do dan cu > mat do dan cu trung binh cua cac tinh mien bac
select *
from province
where countryid='C03' and population>= all(select avg(population)
					from province
					where countryid='C01')